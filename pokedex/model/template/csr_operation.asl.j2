{#- Require structure input like:

```json
{
  "csr_metadata": [
    {
      "name": "csrname",
      "filename": "csrname_301.asl",
      "hex_addr": "0x301",
      "bin_addr": "001100000001",
    }
  ]
}
```

This file will include following path:

    model/csr/{{ filename }}.asl

#}

// --------------
// CSR Dispatcher
// --------------
func ReadCSR(csr : bits(12)) => Result
begin
    case csr of
        {%- for data in csr_metadata %}

        when '{{ data.bin_addr }}' =>
            return Read_{{ data.name | upper() }}();

        {%- endfor %}

        otherwise =>
            return IllegalInstruction();
    end
end

func WriteCSR(csr : bits(12), value : bits(32)) => Result
begin
    case csr of
        {%- for data in csr_metadata %}
        {%- if data.read_write == "true" %}

        when '{{ data.bin_addr }}' =>
            return Write_{{ data.name | upper() }}(value);
        {%- endif %}
        {%- endfor %}

        otherwise =>
            return IllegalInstruction();
    end
end
