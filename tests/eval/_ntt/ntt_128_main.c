// requires VLEN >= 512

#include <stdio.h>

void ntt(const int *array, int l, const int *twiddle, int p, int *dst);

void test() {
  const int l = 7;
  const int n = 128;
  static const int arr[128] = {
      9997,  6362,  7134,  11711, 5849,  9491,  5972,  4164,  5894,  11069,
      7697,  8319,  2077,  12086, 10239, 5394,  4898,  1370,  1205,  2997,
      5274,  4625,  11983, 1789,  3645,  7666,  12128, 10883, 7376,  8883,
      2321,  1889,  2026,  8059,  2741,  865,   1785,  9955,  2395,  9330,
      11465, 7383,  9649,  11285, 3647,  578,   1158,  9936,  12019, 11114,
      7894,  4832,  10148, 10363, 11388, 9122,  10758, 2642,  4171,  10586,
      1194,  5280,  3055,  9220,  10577, 9046,  1284,  7915,  10213, 6902,
      3777,  9896,  429,   7730,  7429,  8666,  10887, 11255, 2437,  7782,
      1327,  7010,  4009,  1038,  9466,  5352,  1473,  10067, 11753, 2019,
      8472,  7665,  2679,  5070,  2248,  3044,  10301, 10671, 2092,  1069,
      9032,  9131,  11715, 6662,  3423,  10027, 5436,  4259,  999,   3316,
      11164, 5597,  6578,  800,   8242,  6952,  2288,  1481,  6770,  11948,
      8938,  10813, 11107, 1362,  4510,  9388,  8840,  10557};
  // const int twiddle[7] = {12149, 7311, 5860, 4134, 8246, 1479, 12288};
  static const int twiddle[] = {
    // layer #0
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 

    // layer #1
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 

    // layer #2
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 

    // layer #3
    1, 1, 1, 1, 1, 1, 1, 1, 4134, 4134, 4134, 4134, 4134, 4134, 4134, 4134, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 8246, 11567, 11567, 11567, 11567, 11567, 11567, 11567, 11567, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 1479, 6553, 6553, 6553, 6553, 6553, 6553, 6553, 6553, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 5146, 1305, 1305, 1305, 1305, 1305, 1305, 1305, 1305, 

    // layer #4
    1, 1, 1, 1, 5860, 5860, 5860, 5860, 4134, 4134, 4134, 4134, 3621, 3621, 3621, 3621, 8246, 8246, 8246, 8246, 1212, 1212, 1212, 1212, 11567, 11567, 11567, 11567, 8785, 8785, 8785, 8785, 1479, 1479, 1479, 1479, 3195, 3195, 3195, 3195, 6553, 6553, 6553, 6553, 9744, 9744, 9744, 9744, 5146, 5146, 5146, 5146, 10643, 10643, 10643, 10643, 1305, 1305, 1305, 1305, 3542, 3542, 3542, 3542, 

    // layer #5
    1, 1, 7311, 7311, 5860, 5860, 3006, 3006, 4134, 4134, 5023, 5023, 3621, 3621, 2625, 2625, 8246, 8246, 8961, 8961, 1212, 1212, 563, 563, 11567, 11567, 5728, 5728, 8785, 8785, 4821, 4821, 1479, 1479, 10938, 10938, 3195, 3195, 9545, 9545, 6553, 6553, 6461, 6461, 9744, 9744, 11340, 11340, 5146, 5146, 5777, 5777, 10643, 10643, 9314, 9314, 1305, 1305, 4591, 4591, 3542, 3542, 2639, 2639, 

    // layer #6
    1, 12149, 7311, 8736, 5860, 2963, 3006, 9275, 4134, 11112, 5023, 9542, 3621, 9198, 2625, 1170, 8246, 726, 8961, 11227, 1212, 2366, 563, 7203, 11567, 2768, 5728, 9154, 8785, 11289, 4821, 955, 1479, 1853, 10938, 4805, 3195, 7393, 9545, 3201, 6553, 4255, 6461, 4846, 9744, 12208, 11340, 9970, 5146, 4611, 5777, 2294, 10643, 9238, 9314, 10963, 1305, 1635, 4591, 8577, 3542, 7969, 2639, 11499, 
  };
  const int p = 12289;
  int dst[128];
  ntt(arr, l, twiddle, p, dst);

  // for (int i = 0; i < n; i++) {
  //   printf("%d", dst[i]);
  //   if ((i + 1) % 8 == 0) {
  //     printf("\n");
  //   } else {
  //     printf(" ");
  //   }
  // }
}
